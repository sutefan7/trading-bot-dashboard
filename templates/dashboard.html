<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trading Bot Dashboard</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        /* Fallback colors if Bootstrap doesn't load */
        .bg-primary { background-color: #0d6efd !important; }
        .bg-success { background-color: #198754 !important; }
        .bg-info { background-color: #0dcaf0 !important; }
        .bg-danger { background-color: #dc3545 !important; }
        .bg-warning { background-color: #ffc107 !important; }
        .text-white { color: white !important; }
        
        /* ============================================================================
           UNIFORME PANEL STRUCTUUR & KLEURENLOGICA
           ============================================================================ */
        
        /* CSS Variabelen (thema) */
        :root {
            --ok: #16a34a;        /* groen */
            --warn: #f59e0b;      /* oranje */
            --risk: #dc2626;      /* rood */
            --muted: #64748b;
            --border: #e5e7eb;
            --focus: #3b82f6;
        }
        
        /* Panel structuur */
        .panel { 
            border-radius: 12px; 
            border: 1px solid var(--border); 
            margin-bottom: 12px; 
            overflow: hidden; 
        }
        
        .panel-header { 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            padding: 12px 14px; 
            cursor: pointer; 
            background: #f8f9fa;
            border-bottom: 1px solid var(--border);
        }
        
        .panel-header:hover {
            background: #e9ecef;
        }
        
        .panel-body { 
            display: block; 
            padding: 16px;
        }
        
        .panel[aria-expanded="false"] .panel-body { 
            display: none; 
        }
        
        .panel-header:focus-visible { 
            outline: 2px solid var(--focus); 
            outline-offset: 2px; 
        }
        
        .chevron { 
            transition: transform .2s ease; 
            font-size: 1.2rem;
            color: var(--muted);
        }
        
        .panel[aria-expanded="false"] .chevron { 
            transform: rotate(-90deg); 
        }
        
        /* KPI styling */
        .kpi { 
            border: 1px solid var(--border); 
            border-radius: 12px; 
            padding: 14px; 
        }
        
        .kpi.ok { 
            background: color-mix(in srgb, var(--ok) 10%, white); 
        }
        
        .kpi.warn { 
            background: color-mix(in srgb, var(--warn) 12%, white); 
        }
        
        .kpi.risk { 
            background: color-mix(in srgb, var(--risk) 10%, white); 
        }
        
        .kpi .label { 
            color: var(--muted); 
            font-size: .9rem; 
        }
        
        .kpi .value { 
            font-weight: 700; 
            font-size: 1.4rem; 
        }
        
        /* Info button styling */
        .info-btn { 
            border: 0; 
            background: transparent; 
            width: 24px; 
            height: 24px; 
            border-radius: 50%;
            display: inline-grid; 
            place-items: center; 
            font-weight: 700; 
            color: var(--muted); 
            cursor: pointer;
        }
        
        .info-btn:hover { 
            background: #f3f4f6; 
        }
        
        /* Tooltip styling */
        .tooltip { 
            position: fixed; 
            transform: translate(-50%, -100%); 
            background: #111827; 
            color: #fff;
            padding: 12px 16px; 
            border-radius: 6px; 
            font-size: .9rem; 
            opacity: 0; 
            pointer-events: none; 
            transition: .12s; 
            z-index: 1000;
            max-width: 400px;
            white-space: pre-line;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            line-height: 1.4;
        }
        
        .tooltip.visible { 
            opacity: 1; 
            transform: translate(-50%, -110%); 
        }
        
        /* Legenda styling */
        .legend { 
            margin: 4px 0 12px; 
        }
        
        .legend summary { 
            cursor: pointer; 
            color: var(--muted); 
        }
        
        .legend .dot { 
            display: inline-block; 
            width: 10px; 
            height: 10px; 
            border-radius: 50%; 
            margin-right: 6px; 
            vertical-align: middle;
        }
        
        /* Panel actions */
        .panel-actions {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .panel-title {
            font-weight: 600;
            font-size: 1.1rem;
        }
    </style>
    
    <!-- Bootstrap JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}?v={{ range(100000000000, 999999999999) | random }}">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-dark bg-dark">
        <div class="container-fluid">
            <span class="navbar-brand mb-0 h1">
                <i class="fas fa-robot"></i> Trading Bot Dashboard
            </span>
            <div class="d-flex">
                <span class="navbar-text me-3" id="last-update">
                    <i class="fas fa-clock"></i> Laatste Update: <span id="last-update-time">Laden...</span>
                </span>
                <button class="btn btn-outline-light btn-sm" onclick="syncNow()">
                    <i class="fas fa-sync-alt"></i> Nu Synchroniseren
                </button>
            </div>
        </div>
    </nav>

    <!-- Global Alert Container -->
    <div id="global-alert"></div>
    
    <!-- Sync Banner -->
    <div id="sync-banner" class="alert alert-info text-center mb-3" style="display: none;">
        Laatste update: --:-- (-- min geleden)
    </div>

    <!-- Main Content -->
    <div class="container-fluid mt-4">
        <!-- Kritieke Waarschuwingen - Bovenaan (standaard verborgen) -->
        <div class="row mb-3" id="critical-alerts-container" style="display: none;">
            <div class="col-12">
                <div class="alert alert-warning alert-dismissible fade show" role="alert">
                    <i class="fas fa-exclamation-triangle me-2"></i>
                    <strong>‚ö†Ô∏è Kritieke Waarschuwing:</strong> 
                    <span id="critical-alert-text">Geen kritieke waarschuwingen</span>
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
            </div>
        </div>

        <!-- System Status - Bovenaan -->
        <div class="row mb-4">
            <div class="col-12">
                <section class="panel" data-panel-id="system-status" aria-expanded="true">
                    <header class="panel-header" role="button" aria-expanded="true" aria-controls="panel-system-status">
                        <div class="panel-title">üñ•Ô∏è Systeem Status</div>
                        <div class="panel-actions">
                            <button class="info-btn" aria-label="Info" data-tooltip="üñ•Ô∏è Systeem Status:&#10;‚Ä¢ Pi Verbinding: Status van Raspberry Pi connectie&#10;‚Ä¢ Laatste Sync: Wanneer data voor het laatst gesynchroniseerd werd&#10;‚Ä¢ Data Bestanden: Aantal beschikbare data bestanden&#10;‚Ä¢ Auto Vernieuwen: Dashboard refresh status">i</button>
                            <span class="chevron" aria-hidden="true">‚ñæ</span>
                        </div>
                    </header>
                    <div id="panel-system-status" class="panel-body">
                        <div class="row">
                            <div class="col-md-3">
                                <strong>Pi Verbinding:</strong>
                                <span id="pi-status" class="badge bg-secondary">Onbekend</span>
                            </div>
                            <div class="col-md-3">
                                <strong>Laatste Sync:</strong>
                                <span id="last-sync">Laden...</span>
                            </div>
                            <div class="col-md-3">
                                <strong>Data Bestanden:</strong>
                                <span id="data-files">0</span>
                            </div>
                            <div class="col-md-3">
                                <strong>Auto Vernieuwen:</strong>
                                <span id="auto-refresh" class="badge bg-success">AAN</span>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </div>
        
        
        
        <!-- Global Controls -->
        <div class="d-flex gap-2 mb-3">
            <button id="expand-all" class="btn btn-sm btn-outline-primary">
                <i class="fas fa-expand-arrows-alt"></i> Alles Uitklappen
            </button>
            <button id="collapse-all" class="btn btn-sm btn-outline-secondary">
                <i class="fas fa-compress-arrows-alt"></i> Alles Inklappen
            </button>
        </div>
        <!-- Top Row - Critical Metrics -->
        <section class="panel" data-panel-id="critical-metrics" aria-expanded="true">
            <header class="panel-header" role="button" aria-expanded="true" aria-controls="panel-critical-metrics">
                <div class="panel-title">üéØ Kritieke Metrics</div>
                <div class="panel-actions">
                    <button class="info-btn" aria-label="Info" data-tooltip="Overzicht van de belangrijkste trading metrics: portfolio waarde, dagelijkse P&L, open posities en risico score">i</button>
                    <span class="chevron" aria-hidden="true">‚ñæ</span>
                </div>
            </header>
            <div id="panel-critical-metrics" class="panel-body">
                <div class="row">
                    <div class="col-md-3 mb-3">
                        <div class="kpi ok" id="kpi-portfolio">
                            <div class="label">üí∞ Portfolio Waarde</div>
                            <div class="value" id="portfolio-value">‚Ç¨1.000,00</div>
                            <small class="text-muted">Startkapitaal: ‚Ç¨1.000</small>
                        </div>
                    </div>
                    <div class="col-md-3 mb-3">
                        <div class="kpi ok" id="kpi-daily-pnl">
                            <div class="label">üìà Dagelijkse P&L</div>
                            <div class="value" id="daily-pnl">‚Ç¨0,00</div>
                            <small class="text-muted">Geen trades vandaag</small>
                        </div>
                    </div>
                    <div class="col-md-3 mb-3">
                        <div class="kpi ok" id="kpi-positions">
                            <div class="label">üìä Open Posities</div>
                            <div class="value" id="open-positions">0</div>
                            <small class="text-muted">Geen actieve trades</small>
                        </div>
                    </div>
                    <div class="col-md-3 mb-3">
                        <div class="kpi ok" id="kpi-risk">
                            <div class="label">‚ö†Ô∏è Risico Score</div>
                            <div class="value" id="risk-score">3.5</div>
                            <small class="text-muted">Gemiddeld risico</small>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Bot Activity & Decision Making - Direct onder gekleurde blokken -->
        <div class="row mb-4">
            <!-- Bot Activity Timeline -->
            <div class="col-lg-8">
                <section class="panel" data-panel-id="bot-activity" aria-expanded="true">
                    <header class="panel-header" role="button" aria-expanded="true" aria-controls="panel-bot-activity">
                        <div class="panel-title">ü§ñ Bot Activiteit & Beslissingen</div>
                        <div class="panel-actions">
                            <button class="info-btn" aria-label="Info" data-tooltip="ü§ñ Bot Activiteit & Beslissingen:&#10;‚Ä¢ Uptime: Hoe lang bot actief is&#10;‚Ä¢ Trading Beslissingen: Elke 12 uur&#10;‚Ä¢ Volgende Trading: Tijd volgende beslissing&#10;‚Ä¢ Activity Timeline: Recente bot acties&#10;‚Ä¢ Beslissingen: Trading beslissingen met parameters&#10;‚Ä¢ Status badges: Geel=Geen actie, Groen=Succes">i</button>
                            <span class="chevron" aria-hidden="true">‚ñæ</span>
                        </div>
                    </header>
                    <div id="panel-bot-activity" class="panel-body">
                        <div class="row mb-3">
                            <div class="col-md-4">
                                <div class="text-center">
                                    <h4 id="bot-uptime" class="text-info">0h 0m</h4>
                                    <small>Bot Uptime</small>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="text-center">
                                    <h4 id="decision-frequency" class="text-primary">0/min</h4>
                                    <small>Trading Beslissingen</small>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="text-center">
                                    <h4 id="next-check" class="text-warning">--:--</h4>
                                    <small>Volgende Trading</small>
                                </div>
                            </div>
                        </div>
                        
                        <div class="table-responsive">
                            <table class="table table-sm table-hover" id="bot-activity-table">
                                <thead>
                                    <tr>
                                        <th>Datum & Tijd</th>
                                        <th>Actie</th>
                                        <th>Beslissing</th>
                                        <th>Reden</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody id="bot-activity-tbody">
                                    <tr>
                                        <td colspan="5" class="text-center text-muted">Bot activiteit laden...</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </section>
            </div>
            
            <!-- Bot Performance Metrics -->
            <div class="col-lg-4">
                <section class="panel" data-panel-id="bot-performance" aria-expanded="true">
                    <header class="panel-header" role="button" aria-expanded="true" aria-controls="panel-bot-performance">
                        <div class="panel-title">üìä Bot Prestaties</div>
                        <div class="panel-actions">
                            <button class="info-btn" aria-label="Info" data-tooltip="üìä Bot Prestaties:&#10;‚Ä¢ Marktanalyse: ML model performance&#10;‚Ä¢ Risico Beoordeling: Risk assessment score&#10;‚Ä¢ Data Sync Snelheid: Hoe snel data van Pi naar Mac wordt gesynchroniseerd (SCP/SSH)&#10;‚Ä¢ Succespercentage: Trading success rate">i</button>
                            <span class="chevron" aria-hidden="true">‚ñæ</span>
                        </div>
                    </header>
                    <div id="panel-bot-performance" class="panel-body">
                        <div class="mb-3">
                            <div class="d-flex justify-content-between">
                                <span id="market-analysis-label">Marktanalyse</span>
                                <span id="market-analysis-score" class="badge bg-secondary">0%</span>
                            </div>
                            <div class="progress mt-1" style="height: 6px;">
                                <div id="market-analysis-bar" class="progress-bar" role="progressbar" style="width: 0%"></div>
                            </div>
                            <small id="market-analysis-details" class="text-muted">Loading...</small>
                        </div>
                        
                        <div class="mb-3">
                            <div class="d-flex justify-content-between">
                                <span id="risk-assessment-label">Risico Beoordeling</span>
                                <span id="risk-assessment-score" class="badge bg-secondary">0%</span>
                            </div>
                            <div class="progress mt-1" style="height: 6px;">
                                <div id="risk-assessment-bar" class="progress-bar bg-warning" role="progressbar" style="width: 0%"></div>
                            </div>
                            <small id="risk-assessment-details" class="text-muted">Loading...</small>
                        </div>
                        
                        <div class="mb-3">
                            <div class="d-flex justify-content-between">
                                <span id="execution-speed-label">Data Sync Snelheid</span>
                                <span id="execution-speed-score" class="badge bg-secondary">0%</span>
                            </div>
                            <div class="progress mt-1" style="height: 6px;">
                                <div id="execution-speed-bar" class="progress-bar bg-success" role="progressbar" style="width: 0%"></div>
                            </div>
                            <small id="execution-speed-details" class="text-muted">Loading...</small>
                        </div>
                        
                        <hr>
                        
                        <div class="row text-center">
                            <div class="col-6">
                                <h5 id="success-rate" class="text-success">0%</h5>
                                <small>Succespercentage</small>
                            </div>
                            <div class="col-6">
                                <h5 id="avg-decision-time" class="text-info">0ms</h5>
                                <small>Gem. Beslissingstijd</small>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </div>

        <!-- Middle Row - Performance Metrics -->
        <div class="row mb-4">
            <div class="col-md-3">
                <div class="card bg-success text-white">
                    <div class="card-body">
                        <div class="d-flex justify-content-between">
                            <div>
                                <h6 class="card-title">Win Rate</h6>
                                <h4 id="win-rate">0%</h4>
                                <small>Percentage winnende trades</small>
                            </div>
                            <div class="align-self-center">
                                <i class="fas fa-percentage fa-2x"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-md-3">
                <div class="card bg-info text-white">
                    <div class="card-body">
                        <div class="d-flex justify-content-between">
                            <div>
                                <h6 class="card-title">Sharpe Ratio</h6>
                                <h4 id="sharpe-ratio">0.0</h4>
                            </div>
                            <div class="align-self-center">
                                <i class="fas fa-chart-bar fa-2x"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-md-3">
                <div class="card bg-primary text-white">
                    <div class="card-body">
                        <div class="d-flex justify-content-between">
                            <div>
                                <h6 class="card-title">ML Confidence</h6>
                                <h4 id="ml-confidence">0%</h4>
                                <small>Model betrouwbaarheid</small>
                            </div>
                            <div class="align-self-center">
                                <i class="fas fa-brain fa-2x"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-md-3">
                <div class="card bg-secondary text-white">
                    <div class="card-body">
                        <div class="d-flex justify-content-between">
                            <div>
                                <h6 class="card-title">Inference Latency</h6>
                                <h4 id="inference-latency">0ms</h4>
                            </div>
                            <div class="align-self-center">
                                <i class="fas fa-tachometer-alt fa-2x"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Bottom Row - System Health -->
        <div class="row mb-4">
            <div class="col-md-3">
                <div class="card bg-success text-white">
                    <div class="card-body">
                        <div class="d-flex justify-content-between">
                            <div>
                                <h6 class="card-title">API Status</h6>
                                <h6 id="api-status">Connected</h6>
                            </div>
                            <div class="align-self-center">
                                <i class="fas fa-plug fa-2x"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-md-3">
                <div class="card bg-info text-white">
                    <div class="card-body">
                        <div class="d-flex justify-content-between">
                            <div>
                                <h6 class="card-title">Data Freshness</h6>
                                <h6 id="data-freshness">2 min</h6>
                            </div>
                            <div class="align-self-center">
                                <i class="fas fa-clock fa-2x"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-md-3">
                <div class="card bg-warning text-white">
                    <div class="card-body">
                        <div class="d-flex justify-content-between">
                            <div>
                                <h6 class="card-title">Memory Usage</h6>
                                <h6 id="memory-usage">65%</h6>
                            </div>
                            <div class="align-self-center">
                                <i class="fas fa-memory fa-2x"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-md-3">
                <div class="card bg-danger text-white">
                    <div class="card-body">
                        <div class="d-flex justify-content-between">
                            <div>
                                <h6 class="card-title">Alerts</h6>
                                <h6 id="total-alerts">0</h6>
                            </div>
                            <div class="align-self-center">
                                <i class="fas fa-exclamation-triangle fa-2x"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Charts Row -->
        <div class="row mb-4">
            <!-- Equity Curve -->
            <div class="col-lg-8">
                <section class="panel" data-panel-id="equity-curve" aria-expanded="true">
                    <header class="panel-header" role="button" aria-expanded="true" aria-controls="panel-equity-curve">
                        <div class="panel-title">üìà Vermogenscurve</div>
                        <div class="panel-actions">
                            <button class="info-btn" aria-label="Info" data-tooltip="üìà Vermogenscurve:&#10;‚Ä¢ Toont portfoliowaarde over tijd&#10;‚Ä¢ Startkapitaal: ‚Ç¨1.000&#10;‚Ä¢ Demo mode: Geen echte trades&#10;‚Ä¢ Updates elke 5 minuten">i</button>
                            <span class="chevron" aria-hidden="true">‚ñæ</span>
                    </div>
                    </header>
                    <div id="panel-equity-curve" class="panel-body">
                        <canvas id="equityChart" height="100"></canvas>
                    </div>
                </section>
            </div>

        <!-- ========================================
             PORTFOLIO & TRADING SECTIE
             ======================================== -->
        <div class="row mb-4">
            <div class="col-12">
                <hr class="my-4">
                <h4 class="text-center text-muted mb-4">üí∞ Portfolio & Trading Performance</h4>
                </div>
            </div>
            
            <!-- Portfolio Overview -->
            <div class="col-lg-4">
                <section class="panel" data-panel-id="portfolio-overview" aria-expanded="true">
                    <header class="panel-header" role="button" aria-expanded="true" aria-controls="panel-portfolio-overview">
                        <div class="panel-title">üí∞ Portfolio Overzicht</div>
                        <div class="panel-actions">
                            <button class="info-btn" aria-label="Info" data-tooltip="üìä Portfolio Overzicht:&#10;‚Ä¢ Totaal Saldo: Huidige portfoliowaarde&#10;‚Ä¢ Beschikbaar Saldo: Vrij beschikbaar voor trading&#10;‚Ä¢ Open Posities: Aantal actieve trades&#10;‚Ä¢ Totaal P&L: Totale winst/verlies sinds start">i</button>
                            <span class="chevron" aria-hidden="true">‚ñæ</span>
                        </div>
                    </header>
                    <div id="panel-portfolio-overview" class="panel-body">
                            <div class="mb-3">
                                <strong>Totaal Saldo:</strong>
                                <span id="total-balance" class="float-end">Laden...</span>
                    </div>
                        <div class="mb-3">
                                <strong>Beschikbaar Saldo:</strong>
                                <span id="available-balance" class="float-end">Laden...</span>
                        </div>
                        <div class="mb-3">
                                <strong>Open Posities:</strong>
                                <span id="open-positions-detail" class="float-end">Laden...</span>
                        </div>
                        <div class="mb-3">
                                <strong>Totaal P&L:</strong>
                                <span id="portfolio-pnl" class="float-end">Laden...</span>
                            </div>
                    </div>
                </section>
            </div>
        </div>

        <!-- Portfolio Details Row -->
        <div class="row mb-4">
            <!-- Portfolio Holdings -->
            <div class="col-lg-8">
                <section class="panel" data-panel-id="portfolio-holdings" aria-expanded="true">
                    <header class="panel-header" role="button" aria-expanded="true" aria-controls="panel-portfolio-holdings">
                        <div class="panel-title">ü™ô Portfolio Bezittingen</div>
                        <div class="panel-actions">
                            <button class="info-btn" aria-label="Info" data-tooltip="Huidige cryptocurrency bezittingen en hun waarde">i</button>
                            <span class="chevron" aria-hidden="true">‚ñæ</span>
                        </div>
                    </header>
                    <div id="panel-portfolio-holdings" class="panel-body">
                        <div class="table-responsive">
                            <table class="table table-hover" id="portfolio-table">
                                <thead>
                                    <tr>
                                        <th>Symbool</th>
                                        <th>Kant</th>
                                        <th>Hoeveelheid</th>
                                        <th>Status</th>
                                        <th>P&L</th>
                                        <th>Saldo</th>
                                    </tr>
                                </thead>
                                <tbody id="portfolio-tbody">
                                    <tr>
                                        <td colspan="6" class="text-center text-muted">Portfolio data laden...</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </section>
            </div>
            
            <!-- Portfolio Allocation -->
            <div class="col-lg-4">
                <section class="panel" data-panel-id="portfolio-allocation" aria-expanded="true">
                    <header class="panel-header" role="button" aria-expanded="true" aria-controls="panel-portfolio-allocation">
                        <div class="panel-title">ü•ß Portfolio Verdeling</div>
                        <div class="panel-actions">
                            <button class="info-btn" aria-label="Info" data-tooltip="ü•ß Portfolio Verdeling:&#10;‚Ä¢ Toont verdeling van bezittingen&#10;‚Ä¢ Cirkeldiagram met percentages&#10;‚Ä¢ Huidige status: Geen bezittingen&#10;‚Ä¢ Updates bij nieuwe trades">i</button>
                            <span class="chevron" aria-hidden="true">‚ñæ</span>
                        </div>
                    </header>
                    <div id="panel-portfolio-allocation" class="panel-body">
                        <canvas id="portfolioChart"></canvas>
                        <div id="portfolio-legend" class="mt-3"></div>
                </div>
                </section>
            </div>
        </div>

        <!-- Trading Performance Row -->
        <div class="row mb-4">
            <!-- Win/Loss Breakdown -->
            <div class="col-lg-6">
                <section class="panel" data-panel-id="win-loss-breakdown" aria-expanded="true">
                    <header class="panel-header" role="button" aria-expanded="true" aria-controls="panel-win-loss-breakdown">
                        <div class="panel-title">üìä Win/Verlies Verdeling</div>
                        <div class="panel-actions">
                            <button class="info-btn" aria-label="Info" data-tooltip="üìä Win/Verlies Verdeling:&#10;‚Ä¢ Toont aantal winnende vs verliezende trades&#10;‚Ä¢ Groen: Winnende trades&#10;‚Ä¢ Rood: Verliezende trades&#10;‚Ä¢ Huidige status: Nog geen trades">i</button>
                            <span class="chevron" aria-hidden="true">‚ñæ</span>
                    </div>
                    </header>
                    <div id="panel-win-loss-breakdown" class="panel-body">
                        <canvas id="winLossChart"></canvas>
                    </div>
                </section>
            </div>
            
            <!-- Trading Stats -->
            <div class="col-lg-6">
                <section class="panel" data-panel-id="trading-stats" aria-expanded="true">
                    <header class="panel-header" role="button" aria-expanded="true" aria-controls="panel-trading-stats">
                        <div class="panel-title">üìà Trading Statistieken</div>
                        <div class="panel-actions">
                            <button class="info-btn" aria-label="Info" data-tooltip="üìà Trading Statistieken:&#10;‚Ä¢ Winnende vs verliezende trades&#10;‚Ä¢ Gemiddelde win/verlies per trade&#10;‚Ä¢ Winst factor (ratio)&#10;‚Ä¢ Huidige status: Nog geen trades">i</button>
                            <span class="chevron" aria-hidden="true">‚ñæ</span>
                    </div>
                    </header>
                    <div id="panel-trading-stats" class="panel-body">
                        <div class="row">
                            <div class="col-6">
                                <div class="text-center">
                                    <h3 id="winning-trades" class="text-success">0</h3>
                                    <small>Winnende Trades</small>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="text-center">
                                    <h3 id="losing-trades" class="text-danger">0</h3>
                                    <small>Verliezende Trades</small>
                                </div>
                            </div>
                        </div>
                        <hr>
                        <div class="row">
                            <div class="col-6">
                                <div class="text-center">
                                    <h4 id="avg-win" class="text-success">$0</h4>
                                    <small>Gemiddelde Win</small>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="text-center">
                                    <h4 id="avg-loss" class="text-danger">$0</h4>
                                    <small>Gemiddeld Verlies</small>
                                </div>
                            </div>
                        </div>
                        <hr>
                        <div class="text-center">
                            <h4 id="profit-factor" class="text-info">0.00</h4>
                            <small>Winst Factor</small>
                        </div>
                    </div>
                </section>
                    </div>
                </div>

        <!-- ========================================
            ML & MARKET INTELLIGENCE SECTIE
            ======================================== -->
        <div class="row mb-4">
            <div class="col-12">
                <hr class="my-4">
                <h4 class="text-center text-muted mb-4">üß† ML & Market Intelligence</h4>
            </div>
        </div>

        <!-- ML Models Overview -->
        <div class="row mb-4">
            <div class="col-12">
                <section class="panel" data-panel-id="ml-models" aria-expanded="true">
                    <header class="panel-header" role="button" aria-expanded="true" aria-controls="panel-ml-models">
                        <div class="panel-title">ü§ñ ML Models Overzicht</div>
                        <div class="panel-actions">
                            <button class="info-btn" aria-label="Info" data-tooltip="ü§ñ ML Models Overzicht:&#10;‚Ä¢ Actieve modellen per coin&#10;‚Ä¢ Training resultaten (accuracy, AUC)&#10;‚Ä¢ Trading performance (win rate, returns)&#10;‚Ä¢ Model details en features&#10;‚Ä¢ Laatste training datum">i</button>
                            <span class="chevron" aria-hidden="true">‚ñæ</span>
                    </div>
                    </header>
                    <div id="panel-ml-models" class="panel-body">
                        <!-- Summary Cards -->
                        <div class="row mb-4">
                            <div class="col-md-3">
                                <div class="card bg-primary text-white">
                                    <div class="card-body text-center">
                                        <h5 id="total-models">0</h5>
                                        <small>Totaal Modellen</small>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="card bg-success text-white">
                                    <div class="card-body text-center">
                                        <h5 id="active-models">0</h5>
                                        <small>Actieve Modellen</small>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="card bg-info text-white">
                                    <div class="card-body text-center">
                                        <h5 id="avg-accuracy">0%</h5>
                                        <small>Gem. Accuracy</small>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="card bg-warning text-white">
                                    <div class="card-body text-center">
                                        <h5 id="avg-win-rate">0%</h5>
                                        <small>Gem. Win Rate</small>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Models Table -->
                        <div class="table-responsive">
                            <table class="table table-hover" id="ml-models-table">
                                <thead class="table-dark">
                                    <tr>
                                        <th>Coin</th>
                                        <th>Model</th>
                                        <th>Type</th>
                                        <th>Training</th>
                                        <th>Accuracy</th>
                                        <th>AUC</th>
                                        <th>Win Rate</th>
                                        <th>Returns</th>
                                        <th>Status</th>
                                        <th>Confidence</th>
                                    </tr>
                                </thead>
                                <tbody id="ml-models-tbody">
                                    <tr>
                                        <td colspan="10" class="text-center text-muted">ML models laden...</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <!-- Model Details (Collapsible) -->
                        <div class="mt-4">
                            <button class="btn btn-outline-primary btn-sm" type="button" data-bs-toggle="collapse" data-bs-target="#model-details" aria-expanded="false">
                                <i class="fas fa-info-circle me-1"></i>Gedetailleerde Model Informatie
                            </button>
                            <div class="collapse mt-3" id="model-details">
                                <div class="card">
                                    <div class="card-body">
                                        <div id="model-details-content">
                                            <p class="text-muted">Selecteer een model voor gedetailleerde informatie...</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </div>

        <!-- ML & AI Insights -->
        <div class="row mb-4">
            <div class="col-lg-6">
                <section class="panel" data-panel-id="ml-model-performance" aria-expanded="true">
                    <header class="panel-header" role="button" aria-expanded="true" aria-controls="panel-ml-model-performance">
                        <div class="panel-title">üß† ML Model Prestaties</div>
                        <div class="panel-actions">
                            <button class="info-btn" aria-label="Info" data-tooltip="üß† ML Model Prestaties:&#10;‚Ä¢ Voorspellingen: Aantal ML predictions vandaag&#10;‚Ä¢ Model Accuraatheid: Cross-validation score&#10;‚Ä¢ Feature Belangrijkheid: Top 5 belangrijkste features&#10;‚Ä¢ Confidence Score: Gemiddelde model confidence">i</button>
                            <span class="chevron" aria-hidden="true">‚ñæ</span>
                        </div>
                    </header>
                    <div id="panel-ml-model-performance" class="panel-body">
                        <div class="row">
                            <div class="col-6 mb-3">
                                <div class="text-center">
                                    <h4 id="predictions-today" class="text-primary">24</h4>
                                    <small class="text-muted">Voorspellingen Vandaag</small>
                                </div>
                            </div>
                            <div class="col-6 mb-3">
                                <div class="text-center">
                                    <h4 id="model-accuracy" class="text-success">82.3%</h4>
                                    <small class="text-muted">Model Accuraatheid</small>
                                </div>
                            </div>
                        </div>
                        <hr>
                        <h6>Feature Belangrijkheid:</h6>
                        <div id="feature-importance">
                            <div class="d-flex justify-content-between mb-1">
                                <span>RSI</span>
                                <span>25%</span>
                            </div>
                            <div class="progress mb-2" style="height: 6px;">
                                <div class="progress-bar" style="width: 25%"></div>
                            </div>
                            <div class="d-flex justify-content-between mb-1">
                                <span>Volume</span>
                                <span>20%</span>
                            </div>
                            <div class="progress mb-2" style="height: 6px;">
                                <div class="progress-bar bg-info" style="width: 20%"></div>
                            </div>
                            <div class="d-flex justify-content-between mb-1">
                                <span>Price Change</span>
                                <span>18%</span>
                            </div>
                            <div class="progress mb-2" style="height: 6px;">
                                <div class="progress-bar bg-success" style="width: 18%"></div>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
            
            <div class="col-lg-6">
                <section class="panel" data-panel-id="signal-quality" aria-expanded="true">
                    <header class="panel-header" role="button" aria-expanded="true" aria-controls="panel-signal-quality">
                        <div class="panel-title">üì° Signaal Kwaliteit</div>
                        <div class="panel-actions">
                            <button class="info-btn" aria-label="Info" data-tooltip="üì° Signaal Kwaliteit:&#10;‚Ä¢ Signaal Sterkte: Huidige trading signal strength&#10;‚Ä¢ Regime Status: Marktcondities (trending/sideways)&#10;‚Ä¢ Universe Selectie: Geselecteerde coins voor trading&#10;‚Ä¢ Risk Score: Huidige risico niveau">i</button>
                            <span class="chevron" aria-hidden="true">‚ñæ</span>
                        </div>
                    </header>
                    <div id="panel-signal-quality" class="panel-body">
                        <div class="row">
                            <div class="col-6 mb-3">
                                <div class="text-center">
                                    <h4 id="signal-strength" class="text-warning">7.2</h4>
                                    <small class="text-muted">Signaal Sterkte</small>
                                </div>
                            </div>
                            <div class="col-6 mb-3">
                                <div class="text-center">
                                    <h4 id="regime-status" class="text-info">Neutral</h4>
                                    <small class="text-muted">Regime Status</small>
                                </div>
                            </div>
                        </div>
                        <hr>
                        <h6>Universe Selectie:</h6>
                        <div class="d-flex flex-wrap gap-1" id="universe-selection">
                            <span class="badge bg-primary">BTC</span>
                            <span class="badge bg-primary">ETH</span>
                            <span class="badge bg-primary">ADA</span>
                            <span class="badge bg-primary">DOT</span>
                            <span class="badge bg-primary">LINK</span>
                        </div>
                        <hr>
                        <div class="row">
                            <div class="col-6">
                                <small class="text-muted">Markt Volatiliteit:</small><br>
                                <strong id="market-volatility">Medium</strong>
                            </div>
                            <div class="col-6">
                                <small class="text-muted">Trend Richting:</small><br>
                                <strong id="trend-direction">Sideways</strong>
                        </div>
                    </div>
                </div>
                </section>
            </div>
        </div>

        <!-- Market Intelligence -->
        <div class="row mb-4">
            <div class="col-lg-6">
                <section class="panel" data-panel-id="market-overview" aria-expanded="true">
                    <header class="panel-header" role="button" aria-expanded="true" aria-controls="panel-market-overview">
                        <div class="panel-title">üìà Markt Overzicht</div>
                        <div class="panel-actions">
                            <button class="info-btn" aria-label="Info" data-tooltip="üìà Markt Overzicht:&#10;‚Ä¢ Volatiliteit Index: Markt volatiliteit score&#10;‚Ä¢ Volume Analyse: Trading volume trends&#10;‚Ä¢ Top Movers: Beste/slechtste performers&#10;‚Ä¢ Markt sentiment en trends">i</button>
                            <span class="chevron" aria-hidden="true">‚ñæ</span>
                        </div>
                    </header>
                    <div id="panel-market-overview" class="panel-body">
                        <div class="row mb-3">
                            <div class="col-6">
                                <div class="text-center">
                                    <h4 id="volatility-index" class="text-warning">6.7</h4>
                                    <small class="text-muted">Volatiliteit Index</small>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="text-center">
                                    <h4 id="volume-analysis" class="text-info">Above Avg</h4>
                                    <small class="text-muted">Volume Analyse</small>
                                </div>
                            </div>
                        </div>
                        <h6>Top Movers:</h6>
                        <div id="top-movers">
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <span><strong>BTC</strong></span>
                                <span class="text-success">+2.3%</span>
                                <small class="text-muted">‚Ç¨45M</small>
                            </div>
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <span><strong>ETH</strong></span>
                                <span class="text-danger">-1.1%</span>
                                <small class="text-muted">‚Ç¨32M</small>
                            </div>
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <span><strong>ADA</strong></span>
                                <span class="text-success">+0.8%</span>
                                <small class="text-muted">‚Ç¨18M</small>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
            
            <div class="col-lg-6">
                <section class="panel" data-panel-id="risk-management" aria-expanded="true">
                    <header class="panel-header" role="button" aria-expanded="true" aria-controls="panel-risk-management">
                        <div class="panel-title">üõ°Ô∏è Risico Management</div>
                        <div class="panel-actions">
                            <button class="info-btn" aria-label="Info" data-tooltip="üõ°Ô∏è Risico Management:&#10;‚Ä¢ Risico Afwijzingen: Aantal afgewezen trades&#10;‚Ä¢ Dagelijks Verlies: Huidige dagelijkse verlies&#10;‚Ä¢ Positie Groottes: Max/avg/min position sizes&#10;‚Ä¢ Correlation Matrix: Positie correlaties">i</button>
                            <span class="chevron" aria-hidden="true">‚ñæ</span>
                        </div>
                    </header>
                    <div id="panel-risk-management" class="panel-body">
                        <div class="row mb-3">
                            <div class="col-6">
                                <div class="text-center">
                                    <h4 id="risk-rejects" class="text-danger">3</h4>
                                    <small class="text-muted">Risico Afwijzingen</small>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="text-center">
                                    <h4 id="daily-loss" class="text-success">‚Ç¨0.00</h4>
                                    <small class="text-muted">Dagelijks Verlies</small>
                                </div>
                            </div>
                        </div>
                        <h6>Positie Groottes:</h6>
                        <div class="row">
                            <div class="col-4 text-center">
                                <small class="text-muted">Max Positie:</small><br>
                                <strong id="max-position">10%</strong>
                            </div>
                            <div class="col-4 text-center">
                                <small class="text-muted">Gem. Positie:</small><br>
                                <strong id="avg-position">5.2%</strong>
                            </div>
                            <div class="col-4 text-center">
                                <small class="text-muted">Totale Exposure:</small><br>
                                <strong id="total-exposure">15.6%</strong>
                            </div>
                        </div>
                        <hr>
                        <h6>Correlatie Matrix:</h6>
                        <div class="row">
                            <div class="col-4 text-center">
                                <small class="text-muted">BTC-ETH:</small><br>
                                <strong id="btc-eth-correlation">0.78</strong>
                            </div>
                            <div class="col-4 text-center">
                                <small class="text-muted">BTC-ADA:</small><br>
                                <strong id="btc-ada-correlation">0.65</strong>
                            </div>
                            <div class="col-4 text-center">
                                <small class="text-muted">ETH-ADA:</small><br>
                                <strong id="eth-ada-correlation">0.72</strong>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </div>

        <!-- Real-time Alerts -->
        <div class="row mb-4">
            <div class="col-lg-6">
                <section class="panel" data-panel-id="critical-alerts" aria-expanded="true">
                    <header class="panel-header" role="button" aria-expanded="true" aria-controls="panel-critical-alerts">
                        <div class="panel-title">‚ö†Ô∏è Kritieke Waarschuwingen</div>
                        <div class="panel-actions">
                            <button class="info-btn" aria-label="Info" data-tooltip="‚ö†Ô∏è Kritieke Waarschuwingen:&#10;‚Ä¢ High Latency: Performance issues&#10;‚Ä¢ API Failures: Connectivity problems&#10;‚Ä¢ Risk Breaches: Risk limit violations&#10;‚Ä¢ Model Drift: ML model degradation">i</button>
                            <span class="chevron" aria-hidden="true">‚ñæ</span>
                        </div>
                    </header>
                    <div id="panel-critical-alerts" class="panel-body">
                        <div id="critical-alerts">
                            <div class="alert alert-info">
                                <div class="d-flex justify-content-between">
                                    <span><i class="fas fa-info-circle"></i> Systeem draait normaal</span>
                                    <small class="text-muted">19:32</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
            
            <div class="col-lg-6">
                <section class="panel" data-panel-id="trading-opportunities" aria-expanded="true">
                    <header class="panel-header" role="button" aria-expanded="true" aria-controls="panel-trading-opportunities">
                        <div class="panel-title">üéØ Trading Kansen</div>
                        <div class="panel-actions">
                            <button class="info-btn" aria-label="Info" data-tooltip="üéØ Trading Kansen:&#10;‚Ä¢ New Signals: Nieuwe trading signalen&#10;‚Ä¢ Position Updates: Status wijzigingen&#10;‚Ä¢ Market Events: Belangrijke markt events&#10;‚Ä¢ System Events: Bot status changes">i</button>
                            <span class="chevron" aria-hidden="true">‚ñæ</span>
                        </div>
                    </header>
                    <div id="panel-trading-opportunities" class="panel-body">
                        <div id="trading-opportunities">
                            <div class="alert alert-warning">
                                <div class="d-flex justify-content-between">
                                    <span><i class="fas fa-signal"></i> Potenti√´le BTC setup gedetecteerd</span>
                                    <small class="text-muted">19:02</small>
                                </div>
                                <small class="text-muted">Confidence: 75% - Status: Monitoring</small>
                        </div>
                    </div>
                </div>
                </section>
            </div>
        </div>

        <!-- Decision Thresholds & Recent Decisions -->
        <div class="row mb-4">
            <!-- Decision Thresholds -->
            <div class="col-lg-6">
                <section class="panel" data-panel-id="decision-thresholds" aria-expanded="true">
                    <header class="panel-header" role="button" aria-expanded="true" aria-controls="panel-decision-thresholds">
                        <div class="panel-title">‚öôÔ∏è Beslisdrempels & Parameters</div>
                        <div class="panel-actions">
                            <button class="info-btn" aria-label="Info" data-tooltip="‚öôÔ∏è Beslisdrempels & Parameters:&#10;‚Ä¢ Prijsverandering: Minimum price change voor signal&#10;‚Ä¢ Volume: Minimum volume threshold&#10;‚Ä¢ RSI: Oversold/overbought levels&#10;‚Ä¢ Risk: Maximum risk per trade">i</button>
                            <span class="chevron" aria-hidden="true">‚ñæ</span>
                        </div>
                    </header>
                    <div id="panel-decision-thresholds" class="panel-body">
                        <div class="row" id="decision-thresholds">
                            <div class="col-6 mb-2">
                                <small class="text-muted">Prijsverandering:</small><br>
                                <strong id="price-threshold">2.5%</strong>
                            </div>
                            <div class="col-6 mb-2">
                                <small class="text-muted">Volume:</small><br>
                                <strong id="volume-threshold">1000</strong>
                            </div>
                            <div class="col-6 mb-2">
                                <small class="text-muted">RSI Oversold:</small><br>
                                <strong id="rsi-oversold">30</strong>
                            </div>
                            <div class="col-6 mb-2">
                                <small class="text-muted">RSI Overbought:</small><br>
                                <strong id="rsi-overbought">70</strong>
                            </div>
                            <div class="col-6 mb-2">
                                <small class="text-muted">Stop Loss:</small><br>
                                <strong id="stop-loss">3%</strong>
                            </div>
                            <div class="col-6 mb-2">
                                <small class="text-muted">Take Profit:</small><br>
                                <strong id="take-profit">5%</strong>
                            </div>
                            <div class="col-6 mb-2">
                                <small class="text-muted">Max Positie:</small><br>
                                <strong id="max-position">10%</strong>
                            </div>
                            <div class="col-6 mb-2">
                                <small class="text-muted">Risico per Trade:</small><br>
                                <strong id="risk-per-trade">2%</strong>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
            
        </div>

    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Custom JavaScript -->
    <script src="{{ url_for('static', filename='js/dashboard.js') }}?v={{ range(100000000000, 999999999999) | random }}"></script>
    
    <!-- Debug Script -->
    <script>
        console.log('üîß Debug script loaded');
        console.log('üîß Testing direct API call...');
        
        // Test if dashboard.js loaded correctly
        setTimeout(() => {
            if (typeof loadAllData === 'function') {
                console.log('‚úÖ loadAllData function found');
            } else {
                console.error('‚ùå loadAllData function not found');
            }
            
            if (typeof updateMLModels === 'function') {
                console.log('‚úÖ updateMLModels function found');
            } else {
                console.error('‚ùå updateMLModels function not found');
            }
            
            // Fallback: manually load ML models data
            if (typeof updateMLModels === 'function') {
                console.log('üîß Loading ML models data manually...');
                fetch('/api/ml-models')
                    .then(response => response.json())
                    .then(data => {
                        console.log('üîß ML Models data loaded:', data);
                        updateMLModels(data);
                    })
                    .catch(error => {
                        console.error('üîß ML Models error:', error);
                    });
            } else {
                console.log('üîß updateMLModels not found, defining fallback...');
                
                // Define fallback function
                window.updateMLModels = function(data) {
                    console.log('üîß Fallback updateMLModels called with data:', data);
                    if (!data || data.error) {
                        console.warn('ML Models data error:', data?.error);
                        return;
                    }

                    // Update summary cards
                    const totalModels = document.getElementById('total-models');
                    const activeModels = document.getElementById('active-models');
                    const avgAccuracy = document.getElementById('avg-accuracy');
                    const avgWinRate = document.getElementById('avg-win-rate');
                    
                    if (totalModels) totalModels.textContent = data.summary.total_models;
                    if (activeModels) activeModels.textContent = data.summary.active_models;
                    if (avgAccuracy) avgAccuracy.textContent = `${(data.summary.avg_accuracy * 100).toFixed(1)}%`;
                    if (avgWinRate) avgWinRate.textContent = `${(data.summary.avg_win_rate * 100).toFixed(1)}%`;

                    // Update models table
                    const tbody = document.getElementById('ml-models-tbody');
                    if (!tbody) {
                        console.error('‚ùå ml-models-tbody element not found');
                        return;
                    }

                    if (data.models.length === 0) {
                        tbody.innerHTML = '<tr><td colspan="10" class="text-center text-muted">Geen ML modellen gevonden</td></tr>';
                        return;
                    }

                    tbody.innerHTML = data.models.map(model => {
                        const statusClass = model.status === 'active' ? 'badge bg-success' : 'badge bg-secondary';
                        const confidenceClass = model.confidence > 0.7 ? 'text-success' : model.confidence > 0.5 ? 'text-warning' : 'text-danger';
                        
                        return `
                            <tr style="cursor: pointer;" onclick="showModelDetails('${model.coin}')">
                                <td><strong>${model.coin}</strong></td>
                                <td><small>${model.model_name}</small></td>
                                <td><small>${model.model_type}</small></td>
                                <td><small>${model.training_date}</small></td>
                                <td><span class="badge bg-info">${(model.performance.accuracy * 100).toFixed(1)}%</span></td>
                                <td><span class="badge bg-primary">${model.performance.auc.toFixed(3)}</span></td>
                                <td><span class="badge bg-success">${(model.trading_performance.win_rate * 100).toFixed(1)}%</span></td>
                                <td><span class="badge ${model.trading_performance.total_return > 0 ? 'bg-success' : 'bg-danger'}">${(model.trading_performance.total_return * 100).toFixed(1)}%</span></td>
                                <td><span class="${statusClass}">${model.status}</span></td>
                                <td><span class="${confidenceClass}">${(model.confidence * 100).toFixed(0)}%</span></td>
                            </tr>
                        `;
                    }).join('');
                    
                    console.log('‚úÖ ML Models table updated via fallback');
                };
                
                // Define fallback showModelDetails function
                window.showModelDetails = function(coin) {
                    console.log(`Showing details for ${coin} model`);
                    
                    const detailsContent = document.getElementById('model-details-content');
                    if (!detailsContent) return;
                    
                    detailsContent.innerHTML = `
                        <h6>Gedetailleerde informatie voor ${coin} model</h6>
                        <p class="text-muted">Klik op een model in de tabel hierboven voor gedetailleerde informatie...</p>
                    `;
                    
                    // Show the collapse
                    const collapse = document.getElementById('model-details');
                    if (collapse) {
                        const bsCollapse = new bootstrap.Collapse(collapse, { show: true });
                    }
                };
                
                // Load ML models data
                fetch('/api/ml-models')
                    .then(response => response.json())
                    .then(data => {
                        console.log('üîß ML Models data loaded via fallback:', data);
                        window.updateMLModels(data);
                    })
                    .catch(error => {
                        console.error('üîß ML Models error via fallback:', error);
                    });
            }
        }, 1000);
        
        fetch('/health')
            .then(response => {
                console.log('üîß Health response status:', response.status);
                return response.json();
            })
            .then(data => {
                console.log('üîß Health data:', data);
            })
            .catch(error => {
                console.error('üîß Health error:', error);
            });
    </script>
    
</body>
</html>
